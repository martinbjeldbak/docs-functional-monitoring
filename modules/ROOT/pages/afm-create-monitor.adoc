= Create a Monitor
ifndef::env-site,env-github[]
include::_attributes.adoc[]
endif::[]

You create monitors via the Functional Monitoring UI or by uploading test suites written in BAT, a Behavior Driven Development (BDD) language. Both methods enable you to create tests against one or more endpoints, and to create test schedules that run at specified intervals. 

This procedure describes creating monitors via the Functional Monitoring UI.

== Before You Begin

* Ensure that your user ID has the Anypoint Monitoring User permission and that it has been assigned the Exchange Administrators role. An administrator for your organization can grant this permission in Anypoint Access Management.
* Determine which endpoints to test and the REST methods that test them.
* Determine the expected return status codes.
* Determine the test interval.
+
The shortest interval is fifteen minutes. Monitors can also run hourly, daily, weekly, or monthly. The schedule begins immediately after creating the monitor, and you can modify the schedule after the monitor has been created. For example:

** Set an hourly schedule to start at a certain number of minutes after the hour begins.
** Set a daily, weekly, or monthly schedule to start at a certain time of day.

* Determine the location in which to execute the monitor.
+
For details, see xref:afm-monitoring-public-apis.adoc[Monitoring the Endpoints of Public APIs] and xref:afm-monitoring-private-apis.adoc[Monitoring the Endpoints of Private APIs].
* Determine if the requests should include additional headers.
* For reporting, obtain one of the following pieces of information:
+
|===
|Reporting Tool |Required Information

|PagerDuty
|RoutingKey

|Slack
|Webhook

|SumoLogic
|Endpoint

|Email
|Email address
|===


== Procedure
To create a monitor:

. Click *Create Monitor* in the *Functional Monitoring* section of Anypoint Monitoring.
. Specify a monitor name.
. Populate the fields with the information gathered in "Before you Begin".
. Click *Create Monitor*.

== Result

The *Monitor Detail* view includes the following actions:

* Tap *Run Now* (image:afm-ui-run-button.png[width=1%,height=1%]) to immediately execute a monitor.
* Tap *View Monitor History* (image:afm-ui-history-button.png[width=1.3%,height=1.3%]) to view a list of recent monitor runs.
* Tap *More* (image:afm-ui-more-button.png[width=0.75%,height=0.75%]) followed by *Edit Monitor* to modify a monitor.
* Tap *More* (image:afm-ui-more-button.png[width=0.75%,height=0.75%]) followed by *Download Monitor* to download a monitor as BAT source.
* Tap *More* (image:afm-ui-more-button.png[width=0.75%,height=0.75%]) followed by *Delete Monitor* to delete a monitor.

Additional displayed information includes:

* The most recent test duration
* Time elapsed since the monitor started running
* The average response time for each activity (for example, DNS lookup), separated by day
* The previous five test execution results, as indicated by *PASSED* or *FAILED* (depending on if the endpoints returned expected codes)
* A table with the current test schedules
* Each endpoint asserted with its HTTP method

[NOTE]
====
Tests silently fail when run time exceeds 120 seconds. As a workaround, download the monitor and split the tests across multiple monitors via the BAT CLI. Run and time each test to ensure their running times are under 120 seconds, then upload the monitors.

Alternatively, to run a monitor more than 120 seconds download the monitor and run it from the BAT CLI.
====

== See Also

 * xref:bat-top.adoc[API Functional Monitoring with the Blackbox Automated Testing (BAT) CLI]
